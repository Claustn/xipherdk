---
categories:
- Everyday
date: "2011-01-29T23:01:48Z"
meta:
  _edit_last: "1"
  _syntaxhighlighter_encoded: "1"
  dsq_thread_id: "6102852776"
status: publish
tags: []
title: Change username/password on scheduled tasks.
---
<p>As stated in a previous post, I have been working on a script to change passwords on scheduled tasks.</p>
<p>I had hoped to find some time to clean up the code, and write some error handling, but a few people asked for the code, so here it is in alpha alpha edition. </p>
<p>ToDo:   <br />Tidy up code    <br />Add some error handling    <br />Add code to update-scheduledtasks created in 2k8(R2) GUI</p>
<p>Description:</p>
<p>The script is assuming you have&#160; Powershell V2, and Quest AD cmdlets.</p>
<p>Here is a picture of the GUI when you run the script.</p>
<p>The Quest AD cmdlets are used to connect to AD, to get a list of computers to check for scheduled tasks</p>
<p><a href="http://www.xipher.dk/assets/images/image12.png" rel="lightbox"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/images/image_thumb12.png" width="244" height="162" /></a></p>
<p><strong>Search Account</strong>:&#160; Search for scheduled tasks running under the supplied account, you can use wildcards. If you supply DomainName\* (Default value), then it will search for scheduled tasks running under a domain account, you <strong>Search Root:</strong> The DN path from where you want to build your computer list</p>
<p>OSName: Default value is *server* it’s the value that is the same for all windows servers… So with this value set, it will only return servers from AD</p>
<p><strong>Filter MachineName: </strong>Default value is “*” which returns all servers,&#160; example “Exchan*” would return all servers whose names start with “Exchan”</p>
<p>The Run scheduled tasks with current credentials is not working, since it is not supported against 2003 servers and below, so I remove the functionality.</p>
<p>&#160;</p>
<p>Here is an example of a result.</p>
<p><a href="http://www.xipher.dk/assets/images/image16.png" rel="lightbox"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/images/image_thumb16.png" width="244" height="77" /></a></p>
<p>You can click on one and edit the username if you like, otherwise you can just mark the ones you want to change password on, holding down ctrl and click each one.</p>
<p><a href="http://www.xipher.dk/assets/images/image15.png" rel="lightbox"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/images/image_thumb15.png" width="244" height="78" /></a></p>
<p>Press Change PWD</p>
<p>&#160;</p>
<p>As stated above, there is no particular error handling,and it takes a while to run depending on how many servers you have.&#160; (I hope to find some time to update the script, to a more “production” ready state soon)</p>
<p>[ps]<br />
########################################################################<br />
# Code Generated By: SAPIEN Technologies, Inc., PrimalForms 2009 v1.1.11.0<br />
# Generated On: 29-01-2011 23:05<br />
# Generated By: CTN<br />
########################################################################</p>
<p>#----------------------------------------------<br />
#region Application Functions<br />
#----------------------------------------------</p>
<p>function OnApplicationLoad {<br />
	#Note: This function runs before the form is created<br />
	#Note: To get the script directory in the Packager use: Split-Path $hostinvocation.MyCommand.path<br />
	#Note: To get the console output in the Packager (Windows Mode) use: $ConsoleOutput (Type: System.Collections.ArrayList)<br />
	#Important: Form controls cannot be accessed in this function<br />
	#TODO: Add snapins and custom code to validate the application load</p>
<p>	return $true #return true for success or false for failure<br />
}</p>
<p>function OnApplicationExit {<br />
	#Note: This function runs after the form is closed<br />
	#TODO: Add custom code to clean up and unload snapins when the application exits</p>
<p>	$script:ExitCode = 0 #Set the exit code for the Packager<br />
}</p>
<p>#endregion</p>
<p>#----------------------------------------------<br />
# Generated Form Function<br />
#----------------------------------------------<br />
function GenerateForm {</p>
<p>	#----------------------------------------------<br />
	#region Import Assemblies<br />
	#----------------------------------------------<br />
	[void][reflection.assembly]::Load(&quot;System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;)<br />
	[void][reflection.assembly]::Load(&quot;System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;)<br />
	[void][reflection.assembly]::Load(&quot;mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;)<br />
	[void][reflection.assembly]::Load(&quot;System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;)<br />
	#endregion</p>
<p>	#----------------------------------------------<br />
	#region Generated Form Objects<br />
	#----------------------------------------------<br />
	[System.Windows.Forms.Application]::EnableVisualStyles()<br />
	$form1 = New-Object System.Windows.Forms.Form<br />
	$progressbar1 = New-Object System.Windows.Forms.ProgressBar<br />
	$label9 = New-Object System.Windows.Forms.Label<br />
	$SchTaskPWD = New-Object System.Windows.Forms.TextBox<br />
	$label8 = New-Object System.Windows.Forms.Label<br />
	$button4 = New-Object System.Windows.Forms.Button<br />
	$label7 = New-Object System.Windows.Forms.Label<br />
	$SchTaskUsr = New-Object System.Windows.Forms.TextBox<br />
	$button3 = New-Object System.Windows.Forms.Button<br />
	$label6 = New-Object System.Windows.Forms.Label<br />
	$srchMachineNameTXT = New-Object System.Windows.Forms.TextBox<br />
	$label5 = New-Object System.Windows.Forms.Label<br />
	$SrchOSNameTXT = New-Object System.Windows.Forms.TextBox<br />
	$label4 = New-Object System.Windows.Forms.Label<br />
	$SrchRootTXT = New-Object System.Windows.Forms.TextBox<br />
	$label2 = New-Object System.Windows.Forms.Label<br />
	$SrchAccountTxt = New-Object System.Windows.Forms.TextBox<br />
	$label1 = New-Object System.Windows.Forms.Label<br />
	$textbox1 = New-Object System.Windows.Forms.TextBox<br />
	$button2 = New-Object System.Windows.Forms.Button<br />
	$datagridview1 = New-Object System.Windows.Forms.DataGridView<br />
	$button1 = New-Object System.Windows.Forms.Button<br />
	$tooltip1 = New-Object System.Windows.Forms.ToolTip<br />
	$InitialFormWindowState = New-Object System.Windows.Forms.FormWindowState<br />
	#endregion Generated Form Objects</p>
<p>	#----------------------------------------------<br />
	# User Generated Script<br />
	#----------------------------------------------</p>
<p>	$FormEvent_Load={<br />
		#TODO: Initialize Form Controls here<br />
		$erroractionpreference = &quot;SilentlyContinue&quot;<br />
		Add-PSSnapin *quest*<br />
		$domainname = (Get-QADRootDSE).Domain.ToString()<br />
		$SrchAccountTxt.Text = &quot;$domainname&quot; + &quot;*&quot;</p>
<p>		$SrchRootTXT.Text = (Get-QADRootDSE).DefaultNamingContextDN.ToString()<br />
		$SrchOSNameTXT.Text = &quot;*Server*&quot;<br />
		$srchMachineNameTXT.Text = &quot;*&quot;<br />
		$SchTaskUsr.text = $env:userdomain + &quot;\&quot; + $env:username<br />
		$array= new-object System.Collections.ArrayList<br />
		$Tasks = @()</p>
<p>	}</p>
<p>	$handler_button1_Click={<br />
	#TODO: Place custom script here</p>
<p>	$Servers = get-QADComputer -SearchRoot $SrchRootTXT.Text -OSName $SrchOSNameTXT.Text -Name $srchMachineNameTXT.Text # | where {$_.name -like $($srchMachineNameTXT.Text)}<br />
	$progressbar1.Maximum = $Servers.Length</p>
<p>	Foreach ($server in $Servers ) {<br />
	$serverFQDN = $server.dnsname</p>
<p>	$progressbar1.value += 1 </p>
<p>	$schtask = Schtasks.exe /query /s $serverFQDN  /V /FO CSV  | ConvertFrom-Csv<br />
	#Write-Host &quot;****************** $($server.name)  Scheduled Tasks  ******************&quot;<br />
	if ($schtask) {</p>
<p>	Foreach ($sch in $schtask) {<br />
	#$Sch.&quot;Run As User&quot;<br />
	if ($Sch.&quot;Run As User&quot; -like &quot;$($domainname)*&quot;) {<br />
	#Write-Host  $serverFQDN    ($Sch.TaskName).replace(&quot;\&quot;,&quot;&quot;)    $Sch.'Run As User'</p>
<p>		$SchedTasks = New-Object System.Object<br />
		$SchedTasks | Add-Member -type NoteProperty -name ServerName -value $serverFQDN<br />
		$SchedTasks | Add-Member -type NoteProperty -name &quot;Scheduled Task&quot; -value ($Sch.TaskName).replace(&quot;\&quot;,&quot;&quot;)<br />
		$SchedTasks | Add-Member -type NoteProperty -name NextRun  -value $Sch.'Next Run Time'<br />
		$SchedTasks | Add-Member -type NoteProperty -name Username  -value $sch.'Run As User'<br />
		$Tasks  += $SchedTasks<br />
		$SchedTasks</p>
<p>	}</p>
<p>	}</p>
<p>	}</p>
<p>	}</p>
<p>	$array.AddRange($tasks)<br />
	$datagridview1.DataSource = $array<br />
	$datagridview1.AutoResizeColumns()</p>
<p>	}<br />
	$handler_button2_Click={<br />
		foreach ($row in $datagridview1.SelectedRows) {<br />
		#[System.Windows.Forms.MessageBox]::Show($row.Cells[0].Value)<br />
		$StrCmd = schtasks.exe /change /s &quot;$($row.Cells[0].Value)&quot; /RU &quot;$($row.Cells[3].Value)&quot; /RP &quot;$($textbox1.text)&quot; /TN &quot;`&quot;$($row.Cells[1].Value)`&quot;&quot;<br />
			#Invoke-Expression $strCmd #|Out-File c:\temp\userlog.txt<br />
			Write-Host $LastExitCode<br />
			Write-Host $StrCmd<br />
			Clear-Variable StrCmd -ErrorAction SilentlyContinue</p>
<p>		}</p>
<p>	}</p>
<p>	$handler_label1_Click={<br />
	#TODO: Place custom script here</p>
<p>	}</p>
<p>	$handler_label2_Click={<br />
	#TODO: Place custom script here</p>
<p>	}</p>
<p>	$handler_button3_Click={<br />
	#TODO: Place custom script here<br />
	if ($textbox1.PasswordChar -notlike &quot;`0&quot; ) {$textbox1.PasswordChar = $null ;$textBox1.Text = $textBox1.Text}<br />
	else  {$textbox1.PasswordChar = &quot;*&quot;;$textBox1.Text = $textBox1.Text}</p>
<p>	}</p>
<p>	$handler_label7_Click={<br />
	#TODO: Place custom script here</p>
<p>	}</p>
<p>	$handler_tooltip1_Popup=[System.Windows.Forms.PopupEventHandler]{<br />
	#Event Argument: $_ = [System.Windows.Forms.PopupEventArgs]<br />
	#TODO: Place custom script here</p>
<p>	}</p>
<p>	$ShowHelp={<br />
	#TODO: Place custom script here<br />
	#display popup help<br />
	Switch ($this.name) {<br />
	&quot;SrchAccountTxt&quot; {$tip=&quot;Examples: `n Domainname\AdminGuy Search for a specific account.`n DomainName\admin* For all usersnames in the domain that starts with admin `n Domainname\* All Domain users&quot;}<br />
	&quot;SrchRootTXT&quot; {$tip=&quot;Enter DN for the OU, that you want to be the base of the AD search&quot;}<br />
	&quot;SrchOSNameTXT&quot;  {$tip=&quot;Enter a complete or partial machinename that you want to search for. Wildcards are permitted `n Exhange* will find all servers whos name starts with 'Exchange'&quot;}<br />
	default {$tip=&quot;No help found for $($this.name)&quot;}<br />
	}<br />
	$tooltip1.SetToolTip($this,$tip)</p>
<p>	}</p>
<p>	$handler_button4_Click={<br />
	#TODO: Place custom script here<br />
	if ($SchTaskPWD.PasswordChar -notlike &quot;`0&quot; ) {$SchTaskPWD.PasswordChar = $null ;$SchTaskPWD.Text = $SchTaskPWD.Text}<br />
	else  {$SchTaskPWD.PasswordChar = &quot;*&quot;;$SchTaskPWD.Text = $SchTaskPWD.Text}<br />
	}</p>
<p>	#----------------------------------------------<br />
	# Generated Events<br />
	#----------------------------------------------</p>
<p>	$Form_StateCorrection_Load=<br />
	{<br />
		#Correct the initial state of the form to prevent the .Net maximized form issue<br />
		$form1.WindowState = $InitialFormWindowState<br />
	}</p>
<p>	#----------------------------------------------<br />
	#region Generated Form Code<br />
	#----------------------------------------------<br />
	#<br />
	# form1<br />
	#<br />
	$form1.Controls.Add($progressbar1)<br />
	$form1.Controls.Add($label9)<br />
	$form1.Controls.Add($SchTaskPWD)<br />
	$form1.Controls.Add($label8)<br />
	$form1.Controls.Add($button4)<br />
	$form1.Controls.Add($label7)<br />
	$form1.Controls.Add($SchTaskUsr)<br />
	$form1.Controls.Add($button3)<br />
	$form1.Controls.Add($label6)<br />
	$form1.Controls.Add($srchMachineNameTXT)<br />
	$form1.Controls.Add($label5)<br />
	$form1.Controls.Add($SrchOSNameTXT)<br />
	$form1.Controls.Add($label4)<br />
	$form1.Controls.Add($SrchRootTXT)<br />
	$form1.Controls.Add($label2)<br />
	$form1.Controls.Add($SrchAccountTxt)<br />
	$form1.Controls.Add($label1)<br />
	$form1.Controls.Add($textbox1)<br />
	$form1.Controls.Add($button2)<br />
	$form1.Controls.Add($datagridview1)<br />
	$form1.Controls.Add($button1)<br />
	$form1.ClientSize = New-Object System.Drawing.Size(897,567)<br />
	$form1.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$form1.Name = &quot;form1&quot;<br />
	$form1.Text = &quot;Change Scheduled Task Passwords v. 0.0.1&quot;<br />
	$form1.add_Load($FormEvent_Load)<br />
	#<br />
	# progressbar1<br />
	#<br />
	$progressbar1.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$progressbar1.Location = New-Object System.Drawing.Point(34,528)<br />
	$progressbar1.Name = &quot;progressbar1&quot;<br />
	$progressbar1.Size = New-Object System.Drawing.Size(829,23)<br />
	$progressbar1.TabIndex = 23<br />
	#<br />
	# label9<br />
	#<br />
	$label9.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$label9.Location = New-Object System.Drawing.Point(505,98)<br />
	$label9.Name = &quot;label9&quot;<br />
	$label9.Size = New-Object System.Drawing.Size(108,23)<br />
	$label9.TabIndex = 22<br />
	$label9.Text = &quot;Schtasks Password&quot;<br />
	#<br />
	# SchTaskPWD<br />
	#<br />
	$SchTaskPWD.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$SchTaskPWD.Location = New-Object System.Drawing.Point(619,95)<br />
	$SchTaskPWD.Name = &quot;SchTaskPWD&quot;<br />
	$SchTaskPWD.PasswordChar = '*'<br />
	$SchTaskPWD.Size = New-Object System.Drawing.Size(161,20)<br />
	$SchTaskPWD.TabIndex = 21<br />
	#<br />
	# label8<br />
	#<br />
	$label8.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$label8.Location = New-Object System.Drawing.Point(505,64)<br />
	$label8.Name = &quot;label8&quot;<br />
	$label8.Size = New-Object System.Drawing.Size(108,23)<br />
	$label8.TabIndex = 20<br />
	$label8.Text = &quot;Schtasks username&quot;<br />
	#<br />
	# button4<br />
	#<br />
	$button4.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$button4.Location = New-Object System.Drawing.Point(786,93)<br />
	$button4.Name = &quot;button4&quot;<br />
	$button4.Size = New-Object System.Drawing.Size(81,23)<br />
	$button4.TabIndex = 19<br />
	$button4.Text = &quot;Toggle PWD&quot;<br />
	$button4.UseVisualStyleBackColor = $True<br />
	$button4.add_Click($handler_button4_Click)<br />
	#<br />
	# label7<br />
	#<br />
	$label7.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$label7.Location = New-Object System.Drawing.Point(506,36)<br />
	$label7.Name = &quot;label7&quot;<br />
	$label7.Size = New-Object System.Drawing.Size(218,23)<br />
	$label7.TabIndex = 18<br />
	$label7.Text = &quot;Run Schtasks with following credentials&quot;<br />
	#<br />
	# SchTaskUsr<br />
	#<br />
	$SchTaskUsr.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$SchTaskUsr.Location = New-Object System.Drawing.Point(619,63)<br />
	$SchTaskUsr.Name = &quot;SchTaskUsr&quot;<br />
	$SchTaskUsr.Size = New-Object System.Drawing.Size(161,20)<br />
	$SchTaskUsr.TabIndex = 17<br />
	#<br />
	# button3<br />
	#<br />
	$button3.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$button3.Location = New-Object System.Drawing.Point(439,123)<br />
	$button3.Name = &quot;button3&quot;<br />
	$button3.Size = New-Object System.Drawing.Size(79,23)<br />
	$button3.TabIndex = 16<br />
	$button3.Text = &quot;Toggle PWD&quot;<br />
	$button3.UseVisualStyleBackColor = $True<br />
	$button3.add_Click($handler_button3_Click)<br />
	#<br />
	# label6<br />
	#<br />
	$label6.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$label6.Location = New-Object System.Drawing.Point(169,92)<br />
	$label6.Name = &quot;label6&quot;<br />
	$label6.Size = New-Object System.Drawing.Size(106,23)<br />
	$label6.TabIndex = 15<br />
	$label6.Text = &quot;Filter MachineName&quot;<br />
	#<br />
	# srchMachineNameTXT<br />
	#<br />
	$srchMachineNameTXT.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$srchMachineNameTXT.Location = New-Object System.Drawing.Point(284,92)<br />
	$srchMachineNameTXT.Name = &quot;srchMachineNameTXT&quot;<br />
	$srchMachineNameTXT.Size = New-Object System.Drawing.Size(148,20)<br />
	$srchMachineNameTXT.TabIndex = 14<br />
	#<br />
	# label5<br />
	#<br />
	$label5.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$label5.Location = New-Object System.Drawing.Point(172,66)<br />
	$label5.Name = &quot;label5&quot;<br />
	$label5.Size = New-Object System.Drawing.Size(101,23)<br />
	$label5.TabIndex = 13<br />
	$label5.Text = &quot;OS Name&quot;<br />
	#<br />
	# SrchOSNameTXT<br />
	#<br />
	$SrchOSNameTXT.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$SrchOSNameTXT.Location = New-Object System.Drawing.Point(284,66)<br />
	$SrchOSNameTXT.Name = &quot;SrchOSNameTXT&quot;<br />
	$SrchOSNameTXT.Size = New-Object System.Drawing.Size(148,20)<br />
	$SrchOSNameTXT.TabIndex = 12<br />
	#<br />
	# label4<br />
	#<br />
	$label4.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$label4.Location = New-Object System.Drawing.Point(172,41)<br />
	$label4.Name = &quot;label4&quot;<br />
	$label4.Size = New-Object System.Drawing.Size(100,23)<br />
	$label4.TabIndex = 11<br />
	$label4.Text = &quot;SearchRoot &quot;<br />
	#<br />
	# SrchRootTXT<br />
	#<br />
	$SrchRootTXT.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$SrchRootTXT.Location = New-Object System.Drawing.Point(284,39)<br />
	$SrchRootTXT.Name = &quot;SrchRootTXT&quot;<br />
	$SrchRootTXT.Size = New-Object System.Drawing.Size(148,20)<br />
	$SrchRootTXT.TabIndex = 10<br />
	#<br />
	# label2<br />
	#<br />
	$label2.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$label2.Location = New-Object System.Drawing.Point(172,14)<br />
	$label2.Name = &quot;label2&quot;<br />
	$label2.Size = New-Object System.Drawing.Size(100,23)<br />
	$label2.TabIndex = 8<br />
	$label2.Text = &quot;Search Accounts&quot;<br />
	#<br />
	# SrchAccountTxt<br />
	#<br />
	$SrchAccountTxt.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$SrchAccountTxt.Location = New-Object System.Drawing.Point(284,12)<br />
	$SrchAccountTxt.Name = &quot;SrchAccountTxt&quot;<br />
	$SrchAccountTxt.Size = New-Object System.Drawing.Size(148,20)<br />
	$SrchAccountTxt.TabIndex = 7<br />
	#<br />
	# label1<br />
	#<br />
	$label1.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$label1.Location = New-Object System.Drawing.Point(172,124)<br />
	$label1.Name = &quot;label1&quot;<br />
	$label1.Size = New-Object System.Drawing.Size(100,23)<br />
	$label1.TabIndex = 6<br />
	$label1.Text = &quot;New Password&quot;<br />
	#<br />
	# textbox1<br />
	#<br />
	$textbox1.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$textbox1.Location = New-Object System.Drawing.Point(284,124)<br />
	$textbox1.Name = &quot;textbox1&quot;<br />
	$textbox1.PasswordChar = '*'<br />
	$textbox1.Size = New-Object System.Drawing.Size(148,20)<br />
	$textbox1.TabIndex = 5<br />
	#<br />
	# button2<br />
	#<br />
	$button2.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$button2.Location = New-Object System.Drawing.Point(71,42)<br />
	$button2.Name = &quot;button2&quot;<br />
	$button2.Size = New-Object System.Drawing.Size(89,23)<br />
	$button2.TabIndex = 4<br />
	$button2.Text = &quot;Change PWD&quot;<br />
	$button2.UseVisualStyleBackColor = $True<br />
	$button2.add_Click($handler_button2_Click)<br />
	#<br />
	# datagridview1<br />
	#<br />
	$System_Windows_Forms_DataGridViewCellStyle_16 = New-Object System.Windows.Forms.DataGridViewCellStyle<br />
	$System_Windows_Forms_DataGridViewCellStyle_16.Alignment = [System.Windows.Forms.DataGridViewContentAlignment]::MiddleLeft<br />
	$System_Windows_Forms_DataGridViewCellStyle_16.BackColor = [System.Drawing.Color]::FromArgb(255,240,240,240)<br />
	$System_Windows_Forms_DataGridViewCellStyle_16.Font = New-Object System.Drawing.Font(&quot;Microsoft Sans Serif&quot;,8.25,0,3,1)<br />
	$System_Windows_Forms_DataGridViewCellStyle_16.ForeColor = [System.Drawing.Color]::FromArgb(255,0,0,0)<br />
	$System_Windows_Forms_DataGridViewCellStyle_16.SelectionBackColor = [System.Drawing.Color]::FromArgb(255,51,153,255)<br />
	$System_Windows_Forms_DataGridViewCellStyle_16.SelectionForeColor = [System.Drawing.Color]::FromArgb(255,255,255,255)<br />
	$System_Windows_Forms_DataGridViewCellStyle_16.WrapMode = [System.Windows.Forms.DataGridViewTriState]::True<br />
	$datagridview1.ColumnHeadersDefaultCellStyle = $System_Windows_Forms_DataGridViewCellStyle_16<br />
	$datagridview1.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$System_Windows_Forms_DataGridViewCellStyle_17 = New-Object System.Windows.Forms.DataGridViewCellStyle<br />
	$System_Windows_Forms_DataGridViewCellStyle_17.Alignment = [System.Windows.Forms.DataGridViewContentAlignment]::MiddleLeft<br />
	$System_Windows_Forms_DataGridViewCellStyle_17.BackColor = [System.Drawing.Color]::FromArgb(255,255,255,255)<br />
	$System_Windows_Forms_DataGridViewCellStyle_17.Font = New-Object System.Drawing.Font(&quot;Microsoft Sans Serif&quot;,8.25,0,3,1)<br />
	$System_Windows_Forms_DataGridViewCellStyle_17.ForeColor = [System.Drawing.Color]::FromArgb(255,0,0,0)<br />
	$System_Windows_Forms_DataGridViewCellStyle_17.SelectionBackColor = [System.Drawing.Color]::FromArgb(255,51,153,255)<br />
	$System_Windows_Forms_DataGridViewCellStyle_17.SelectionForeColor = [System.Drawing.Color]::FromArgb(255,255,255,255)<br />
	$System_Windows_Forms_DataGridViewCellStyle_17.WrapMode = [System.Windows.Forms.DataGridViewTriState]::False<br />
	$datagridview1.DefaultCellStyle = $System_Windows_Forms_DataGridViewCellStyle_17<br />
	$datagridview1.Location = New-Object System.Drawing.Point(34,165)<br />
	$datagridview1.Name = &quot;datagridview1&quot;<br />
	$System_Windows_Forms_DataGridViewCellStyle_18 = New-Object System.Windows.Forms.DataGridViewCellStyle<br />
	$System_Windows_Forms_DataGridViewCellStyle_18.Alignment = [System.Windows.Forms.DataGridViewContentAlignment]::MiddleLeft<br />
	$System_Windows_Forms_DataGridViewCellStyle_18.BackColor = [System.Drawing.Color]::FromArgb(255,240,240,240)<br />
	$System_Windows_Forms_DataGridViewCellStyle_18.Font = New-Object System.Drawing.Font(&quot;Microsoft Sans Serif&quot;,8.25,0,3,1)<br />
	$System_Windows_Forms_DataGridViewCellStyle_18.ForeColor = [System.Drawing.Color]::FromArgb(255,0,0,0)<br />
	$System_Windows_Forms_DataGridViewCellStyle_18.SelectionBackColor = [System.Drawing.Color]::FromArgb(255,51,153,255)<br />
	$System_Windows_Forms_DataGridViewCellStyle_18.SelectionForeColor = [System.Drawing.Color]::FromArgb(255,255,255,255)<br />
	$System_Windows_Forms_DataGridViewCellStyle_18.WrapMode = [System.Windows.Forms.DataGridViewTriState]::True<br />
	$datagridview1.RowHeadersDefaultCellStyle = $System_Windows_Forms_DataGridViewCellStyle_18<br />
	$datagridview1.Size = New-Object System.Drawing.Size(829,356)<br />
	$datagridview1.TabIndex = 2<br />
	#<br />
	# button1<br />
	#<br />
	$button1.DataBindings.DefaultDataSourceUpdateMode = [System.Windows.Forms.DataSourceUpdateMode]::OnValidation<br />
	$button1.Location = New-Object System.Drawing.Point(71,12)<br />
	$button1.Name = &quot;button1&quot;<br />
	$button1.Size = New-Object System.Drawing.Size(89,23)<br />
	$button1.TabIndex = 1<br />
	$button1.Text = &quot;Get Servers&quot;<br />
	$button1.UseVisualStyleBackColor = $True<br />
	$button1.add_Click($handler_button1_Click)<br />
	#<br />
	# tooltip1<br />
	#<br />
	#endregion Generated Form Code</p>
<p>	#----------------------------------------------
#Save the initial state of the form  
 $InitialFormWindowState = $form1.WindowState  
 #Init the OnLoad event to correct the initial state of the form  
 $form1.add\_Load($Form\_StateCorrection\_Load)  
 #Show the Form  
 return $form1.ShowDialog()

} #End Function

#Call OnApplicationLoad to initialize  
if(OnApplicationLoad -eq $true)  
{  
 #Create the form  
 GenerateForm | Out-Null  
 #Perform cleanup  
 OnApplicationExit  
}

[/ps]

