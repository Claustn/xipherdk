<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.79.0" />

    
    
    

<title>Playing around with profiles. • XenoBlog</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Playing around with profiles."/>
<meta name="twitter:description" content="In PowerShell you have the option create custom profiles that you can use, in the profiles you can create different aliases, change the prompt and a lot of other things, today we will look at adding some info to prompt."/>

<meta property="og:title" content="Playing around with profiles." />
<meta property="og:description" content="In PowerShell you have the option create custom profiles that you can use, in the profiles you can create different aliases, change the prompt and a lot of other things, today we will look at adding some info to prompt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2007-07-10-playing-around-with-profiles/" />
<meta property="article:published_time" content="2007-07-10T11:08:02+00:00" />
<meta property="article:modified_time" content="2007-07-10T11:08:02+00:00" /><meta property="og:site_name" content="XenoBlog" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/dracula.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.9181f25ed2263aeb878ec6f8a84f10c4ebb16150000fca8767308880bdde5ca0.css" integrity="sha256-kYHyXtImOuuHjsb4qE8QxOuxYVAAD8qHZzCIgL3eXKA=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="/">
        
          XenoBlog
        
        </a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="/assets/images/me.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">XenoBlog</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/portfolio/">
						<span>Portfolio</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>AboutMe</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/claustn" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://facebook.com/claus.t.nielsen.37" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/claustn" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/claustn" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	
	<a href="mailto:claustnspam@gmail.com" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2007 - 2020 Xenophane
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Playing around with profiles.</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Jul 10, 2007
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/tech-stuff">TECH STUFF</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/code">code</a>
           
      
          <a class="badge badge-tag" href="/tags/link">link</a>
           
      
          <a class="badge badge-tag" href="/tags/playing">playing</a>
           
      
          <a class="badge badge-tag" href="/tags/posh">posh</a>
           
      
          <a class="badge badge-tag" href="/tags/powershell">powershell</a>
           
      
          <a class="badge badge-tag" href="/tags/profile">profile</a>
           
      
          <a class="badge badge-tag" href="/tags/prompt">prompt</a>
           
      
          <a class="badge badge-tag" href="/tags/ps">ps</a>
           
      
          <a class="badge badge-tag" href="/tags/scripting">scripting</a>
           
      
          <a class="badge badge-tag" href="/tags/xenophane">xenophane</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 3 min read
</div>


  </header>
  
  
  <div class="post">
    <p>In PowerShell you have the option create custom profiles that you can use, in the profiles you can create different aliases, change the prompt and a lot of other things, today we will look at adding some info to prompt. First we need to open profiles.ps1 , this file can be put in the WindowsPowershell folder under System32, or in the users \My Documents\WindowsPowerShell. If you are running vista, and want to play around with your profiles.ps1 file, I would put it in the \My Documents\WindowsPowerShell folder, since you have permission to write to files in that dir. (You can read more about profiles<a href="http://pshell.info/basics/133/customizing-powershell-with-a-profile/">here</a><br>
Well ok… on with the coding.. Lets say you want to add some basic info to your prompt.<br>
When you start up powershell for the first time, your prompt will be defined as</p>
<p> <code>“PS “ + $(get-location) + &quot;&gt;”</code></p>
<p>When you open your profile.ps1 file (There is a template in C:\Windows\System32\WindowsPowerShell\v1.0\Examples\profile.ps1) you will find a function called<br>
“ prompt”, this is where you will make the following changes.<br>
The simplest alteration you can make is changing PS to your name</p>
<p><code>“Xenophane “ + $(get-location) + &quot;&gt;” </code><br>
Will give a prompt like this “Xenophane C:\Users\xen_”</p>
<p>What if you want to know something about the system at the prompt, is that possible…. Of course it is…<br>
Let say you want to know how many processes you are running</p>
<p><code>function prompt { &quot;Processes &quot; + (Get-Process).Count+ &quot; &quot; + $(get-location) + &quot;&gt; &quot; }</code><br>
Will give you a prompt like this: “ Processes 71 C:\Users\ctn_”</p>
<p>But it is very annoying to see that info on the same line as your cursor, so lets add the info on the line over the cursor, and add some more information.</p>
<p>`
function prompt
{
[wmi]$Global:Cdrive=Get-WmiObject -query &ldquo;Select * from win32_logicaldisk where deviceid=&lsquo;c:'&rdquo;
#Define Cdrive as global variable, which is type cast as a wmi
$processcount=(Get-Process).Count
#Define variable processcount as number of processes running
$cpuload=(Get-WmiObject win32_processor).loadpercentage
#cpuload is defined as a variable
$diskinfoC=&quot; Free C: &ldquo;+&quot;{0:N2}&rdquo; -f (($global:Cdrive.freespace/1gb)/($global:cdrive.size/1gb)*100)+&quot;%&quot;
#diskinfoC is defined, {0:N2} is .NET for 2 decimal places, -f is a the &ldquo;format&rdquo; property of the string object.</p>
<h1 id="then-the-amount-of-free-space-on-drive-c-is-divided-by-the-size-of-drive-c-multiplies-by-100-to-get">Then the amount of free space on drive C is divided by the size of drive C multiplies by 100 to get</h1>
<p>#the percentage of free space.
$time=Get-WmiObject -class Win32_OperatingSystem
#Define $time is object Win32_OperatingSystem
$t=$time.ConvertToDateTime($time.Lastbootuptime)
#Define #t as the result of the convertion of LastBootuptime into a readable dateTime format.
[TimeSpan]$uptime=New-TimeSpan $t $(get-date)
#Typecast the variable $uptime as a [timespan], the timespan cmdlet in powershell is a way to do date arithmetic in ps
#This way we can compare our variable $t (Which was Lastbootuptime) and the current time Get-date cmdlet
$up=&quot;$($uptime.days)d $($uptime.hours)h $($uptime.minutes)m $($uptime.seconds)s&quot;
#define variable $up to display the uptime in days/hours/minuted/seconds
$TextToDisplay=&ldquo;CPU:&quot;+$cpuload+&quot;% Processes:&rdquo; + $processcount + $diskinfoC+ &quot; &quot; + $diskinfoG+ &quot; &ldquo;+ ([char]0x25b2)+$up +&rdquo; &ldquo;+(Get-Date -format g)
#define one variable that contains all the data we collected so far.
Write-Host -fore red $TextToDisplay
#Write the information to the screen in red
Write-Host &ldquo;My PoSh:&rdquo; $(get-location) -nonewline
#Display the regular prompt.
}
`<br>
One other thing to be aware of is that PowerShell by default will not let you run scripts, so in order to run scripts like profile.ps1 you need to loosen up the security, to get help you can type the command &ldquo;get-help about_signing&rdquo; in a powershell command prompt. I have chosen to use RemotedSigned which will let me run scripts locally on the machine. But you can read about the different security levels in the help file.</p>
<p><a href="http://www.xipher.dk/assets/images/2007/07/profile-published.txt" title="Profile txt file">Profile txt file</a></p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/2007-06-28-a-little-more-fun-with-the-eventlog-in-powershell/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">A little more fun with the eventlog in PowerShell</span>
    </a>
    
    
    <a href="/posts/2007-09-25-speedreading/" class="navigation-next">
      <span class="navigation-tittle">SpeedReading</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    
        <div id="disqus_thread"></div>
<script type="text/javascript">
    

    (function () {
    if (location.hostname === "localhost" ||
      location.hostname === "127.0.0.1" ||
      location.hostname === "") {
      return;
    }
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    var disqus_shortname = 'xipher-1';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || 
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<noscript>
  Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by
  <span class="logo-disqus">Disqus</span>
</a>

    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.12.1/js/all.js" integrity="sha384-ZbbbT1gw3joYkKRqh0kWyRp32UAvdqkpbLedQJSlnI8iLQcFVxaGyrOgOJiDQTTR" crossorigin="anonymous"></script>


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/powershell.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/sql.min.js"></script>
            
        
    <script type="text/javascript">
        
        hljs.configure({languages: ["powershell, sql"]});
        
        hljs.initHighlightingOnLoad();
    </script>
    



    



    </body>
</html>
